{"version":3,"sources":["dist/router.js"],"names":["global","factory","exports","module","require","define","amd","hyperappRouter","hyperapp","this","getOrigin","loc","protocol","hostname","port","createMatch","isExact","path","url","params","trimTrailingSlash","len","length","slice","decodeParam","val","decodeURIComponent","e","location$1","state","pathname","window","location","previous","actions","go","history","pushState","set","data","subscribe","handleLocationChange","detail","unwrap","reduce","next","key","fn","title","call","dispatchEvent","CustomEvent","addEventListener","removeEventListener","Link","props","children","to","onclick","href","anchorElement","defaultPrevented","button","altKey","metaKey","ctrlKey","shiftKey","target","currentTarget","preventDefault","h","Route","match","options","exact","paths","split","urls","i","parseRoute","parent","render","Switch","child","Redirect","replaceState","from"],"mappings":"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","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('hyperapp')) :\n  typeof define === 'function' && define.amd ? define(['exports', 'hyperapp'], factory) :\n  (factory((global.hyperappRouter = {}),global.hyperapp));\n}(this, (function (exports,hyperapp) { 'use strict';\n\n  function getOrigin(loc) {\n    return loc.protocol + \"//\" + loc.hostname + (loc.port ? \":\" + loc.port : \"\")\n  }\n\n  function isExternal(anchorElement) {\n    // Location.origin and HTMLAnchorElement.origin are not\n    // supported by IE and Safari.\n    return getOrigin(location) !== getOrigin(anchorElement)\n  }\n\n  function Link(props, children) {\n    return function(state, actions) {\n      var to = props.to;\n      var location = state.location;\n      var onclick = props.onclick;\n      delete props.to;\n      delete props.location;\n\n      props.href = to;\n      props.onclick = function(e) {\n        if (onclick) {\n          onclick(e);\n        }\n        if (\n          e.defaultPrevented ||\n          e.button !== 0 ||\n          e.altKey ||\n          e.metaKey ||\n          e.ctrlKey ||\n          e.shiftKey ||\n          props.target === \"_blank\" ||\n          isExternal(e.currentTarget)\n        ) {\n        } else {\n          e.preventDefault();\n\n          if (to !== location.pathname) {\n            history.pushState(location.pathname, \"\", to);\n          }\n        }\n      };\n\n      return hyperapp.h(\"a\", props, children)\n    }\n  }\n\n  function createMatch(isExact, path, url, params) {\n    return {\n      isExact: isExact,\n      path: path,\n      url: url,\n      params: params\n    }\n  }\n\n  function trimTrailingSlash(url) {\n    for (var len = url.length; \"/\" === url[--len]; );\n    return url.slice(0, len + 1)\n  }\n\n  function decodeParam(val) {\n    try {\n      return decodeURIComponent(val)\n    } catch (e) {\n      return val\n    }\n  }\n\n  function parseRoute(path, url, options) {\n    if (path === url || !path) {\n      return createMatch(path === url, path, url)\n    }\n\n    var exact = options && options.exact;\n    var paths = trimTrailingSlash(path).split(\"/\");\n    var urls = trimTrailingSlash(url).split(\"/\");\n\n    if (paths.length > urls.length || (exact && paths.length < urls.length)) {\n      return\n    }\n\n    for (var i = 0, params = {}, len = paths.length, url = \"\"; i < len; i++) {\n      if (\":\" === paths[i][0]) {\n        params[paths[i].slice(1)] = urls[i] = decodeParam(urls[i]);\n      } else if (paths[i] !== urls[i]) {\n        return\n      }\n      url += urls[i] + \"/\";\n    }\n\n    return createMatch(false, path, url.slice(0, -1), params)\n  }\n\n  function Route(props) {\n    return function(state, actions) {\n      var location = state.location;\n      var match = parseRoute(props.path, location.pathname, {\n        exact: !props.parent\n      });\n\n      return (\n        match &&\n        props.render({\n          match: match,\n          location: location\n        })\n      )\n    }\n  }\n\n  function Switch(props, children) {\n    return function(state, actions) {\n      var child,\n        i = 0;\n      while (\n        !(child = children[i] && children[i](state, actions)) &&\n        i < children.length\n      )\n        i++;\n      return child\n    }\n  }\n\n  function Redirect(props) {\n    return function(state, actions) {\n      var location = state.location;\n      history.replaceState(props.from || location.pathname, \"\", props.to);\n    }\n  }\n\n  function wrapHistory(keys) {\n    return keys.reduce(function(next, key) {\n      var fn = history[key];\n\n      history[key] = function(data, title, url) {\n        fn.call(this, data, title, url);\n        dispatchEvent(new CustomEvent(\"pushstate\", { detail: data }));\n      };\n\n      return function() {\n        history[key] = fn;\n        next && next();\n      }\n    }, null)\n  }\n\n  var location$1 = {\n    state: {\n      pathname: window.location.pathname,\n      previous: window.location.pathname\n    },\n    actions: {\n      go: function(pathname) {\n        history.pushState(null, \"\", pathname);\n      },\n      set: function(data) {\n        return data\n      }\n    },\n    subscribe: function(actions) {\n      function handleLocationChange(e) {\n        actions.set({\n          pathname: window.location.pathname,\n          previous: e.detail\n            ? (window.location.previous = e.detail)\n            : window.location.previous\n        });\n      }\n\n      var unwrap = wrapHistory([\"pushState\", \"replaceState\"]);\n\n      addEventListener(\"pushstate\", handleLocationChange);\n      addEventListener(\"popstate\", handleLocationChange);\n\n      return function() {\n        removeEventListener(\"pushstate\", handleLocationChange);\n        removeEventListener(\"popstate\", handleLocationChange);\n        unwrap();\n      }\n    }\n  };\n\n  exports.Link = Link;\n  exports.Route = Route;\n  exports.Switch = Switch;\n  exports.Redirect = Redirect;\n  exports.location = location$1;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=router.js.map\n"]}